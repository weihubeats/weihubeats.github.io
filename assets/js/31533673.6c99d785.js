"use strict";(globalThis.webpackChunkweihubeats_website=globalThis.webpackChunkweihubeats_website||[]).push([[9010],{71747(e,n,r){r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"other/\u65f6\u5e8f\u56fe","title":"\u65f6\u5e8f\u56fe","description":"\u4e3b\u8981\u9884\u53d1","source":"@site/docs/other/\u65f6\u5e8f\u56fe.md","sourceDirName":"other","slug":"/other/\u65f6\u5e8f\u56fe","permalink":"/docs/other/\u65f6\u5e8f\u56fe","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/other/\u65f6\u5e8f\u56fe.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Docusaurus\u641c\u7d22\u63d2\u4ef6\u5b89\u88c5\u4f7f\u7528","permalink":"/docs/other/Docusaurus\u641c\u7d22\u63d2\u4ef6\u5b89\u88c5\u4f7f\u7528"},"next":{"title":"python\u65b0\u589e\u865a\u62df\u73af\u5883","permalink":"/docs/python/python\u65b0\u589e\u865a\u62df\u73af\u5883"}}');var t=r(74848),s=r(28453);const i={},a=void 0,c={},l=[{value:"\u4e3b\u8981\u9884\u53d1",id:"\u4e3b\u8981\u9884\u53d1",level:2},{value:"\u4e00\u4e2a\u6bd4\u8f83\u597d\u7684\u4f8b\u5b50",id:"\u4e00\u4e2a\u6bd4\u8f83\u597d\u7684\u4f8b\u5b50",level:2}];function d(e){const n={code:"code",h2:"h2",li:"li",mermaid:"mermaid",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"\u4e3b\u8981\u9884\u53d1",children:"\u4e3b\u8981\u9884\u53d1"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u5f00\u59cb: sequenceDiagram"}),"\n",(0,t.jsx)(n.li,{children:"\u81ea\u52a8\u751f\u6210\u6570\u5b57\u5e8f\u5217: autonumber"}),"\n",(0,t.jsxs)(n.li,{children:["\u989c\u8272\u5305\u88f9: ",(0,t.jsx)(n.code,{children:"rect rgb(255, 250, 240) end"})]}),"\n",(0,t.jsxs)(n.li,{children:["A\u5bf9\u8c61\u5230B\u5bf9\u8c61: ",(0,t.jsx)(n.code,{children:"A->>B: xxx"})]}),"\n",(0,t.jsxs)(n.li,{children:["\u5907\u6ce8\uff1a",(0,t.jsx)(n.code,{children:"Note right of AC_TRANSIT: xx\u5907\u6ce8"})]}),"\n",(0,t.jsxs)(n.li,{children:["\u865a\u7bad\u5934: ",(0,t.jsx)(n.code,{children:"A--\x3e>B: xxx"})]}),"\n",(0,t.jsxs)(n.li,{children:["\u5355\u4e2a\u6d41\u7a0b\u5f00\u59cb: ",(0,t.jsx)(n.code,{children:"A->>+B: xxx"})]}),"\n",(0,t.jsxs)(n.li,{children:["\u5355\u4e2a\u6d41\u7a0b\u7ed3\u675f: ",(0,t.jsx)(n.code,{children:"A->>-B: xxx"})]}),"\n",(0,t.jsxs)(n.li,{children:["\u5b9a\u4e49\u8282\u70b9: ",(0,t.jsx)(n.code,{children:"participant ass xxx"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"\u4e00\u4e2a\u6bd4\u8f83\u597d\u7684\u4f8b\u5b50",children:"\u4e00\u4e2a\u6bd4\u8f83\u597d\u7684\u4f8b\u5b50"}),"\n",(0,t.jsx)(n.mermaid,{value:'sequenceDiagram\n    autonumber\n    actor User as \ud83d\udc68\u200d\ud83d\udcbb \u8fd0\u7ef4/DBA\n    participant Aurora as \ud83d\uddc4\ufe0f \u4e0a\u6e38 Aurora\n    participant Ghost as \ud83d\udc7b gh-ost\n    participant DTS as \ud83d\udd04 \u963f\u91cc\u4e91 DTS\n    participant Down as \ud83d\udcc9 \u4e0b\u6e38 RDS/ADB\n\n    Note over User, Down: \ud83d\uded1 \u7b2c\u4e00\u9636\u6bb5\uff1a\u524d\u7f6e\u914d\u7f6e (\u9632\u6b62\u6d41\u91cf\u7206\u70b8)\n    User->>DTS: 1. \u4fee\u6539 DTS \u914d\u7f6e\uff0c\u8fc7\u6ee4\u8868\u5bf9\u8c61<br/>(\u5c4f\u853d _.*_gho, _.*_del)\n    DTS--\x3e>User: \u914d\u7f6e\u751f\u6548 (DTS \u6b64\u65f6\u4e0d\u518d\u540c\u6b65\u4e34\u65f6\u8868)\n\n    Note over User, Down: \ud83d\ude80 \u7b2c\u4e8c\u9636\u6bb5\uff1a\u542f\u52a8\u8fc1\u79fb (\u4e0a\u6e38\u5f00\u59cb\u8dd1\u6570\u636e)\n    User->>Ghost: 2. \u542f\u52a8 gh-ost (screen\u540e\u53f0)<br/>\u5e26\u53c2\u6570 --postpone-cut-over-flag-file\n    Ghost->>Aurora: \u521b\u5efa _gho \u4e34\u65f6\u8868\n    Ghost->>Aurora: \u5f00\u59cb\u5168\u91cf\u62f7\u8d1d + Binlog \u5e94\u7528\n    \n    rect rgb(240, 248, 255)\n        Note right of Ghost: \u23f3 \u8017\u65f6\u64cd\u4f5c\uff1a\u6570\u636e\u62f7\u8d1d\u4e2d... <br/>(DTS \u4fdd\u6301\u8fd0\u884c\uff0c\u4e1a\u52a1\u65e0\u611f\u77e5)\n    end\n\n    Note over User, Down: \ud83d\udee0\ufe0f \u7b2c\u4e09\u9636\u6bb5\uff1a\u4e0b\u6e38\u5e76\u884c\u6539\u9020 (\u5229\u7528\u62f7\u8d1d\u7a7a\u7a97\u671f)\n    User->>DTS: 3. \u6682\u505c DTS \u4efb\u52a1\n    User->>Down: 4. \u624b\u52a8\u6267\u884c ALTER TABLE ... MODIFY INT\n    Down--\x3e>User: \u6267\u884c\u5b8c\u6210 (\u4e0b\u6e38\u5df2\u53d8\u6210 INT)\n    User->>DTS: 5. \u6062\u590d DTS \u4efb\u52a1\n    \n    rect rgb(230, 255, 230)\n        Note right of DTS: \u2705 \u517c\u5bb9\u72b6\u6001\uff1a<br/>Aurora(TINYINT) -> DTS -> Down(INT)<br/>\u540c\u6b65\u6b63\u5e38\u8fdb\u884c\n    end\n\n    Note over User, Down: \u2702\ufe0f \u7b2c\u56db\u9636\u6bb5\uff1a\u6b63\u5f0f\u5207\u6362 (Cut-over)\n    Ghost--\x3e>User: \u8fdb\u5ea6 100%, \u72b6\u6001: Postponing cut-over\n    User->>User: 6. \u786e\u8ba4 Aurora \u65e0\u957f\u4e8b\u52a1/\u6162SQL\n    User->>Ghost: 7. \u5220\u9664\u6807\u5fd7\u6587\u4ef6 (\u89e6\u53d1\u5207\u6362)\n    \n    activate Ghost\n    Ghost->>Aurora: 8. \u83b7\u53d6 MDL \u9501, \u6267\u884c RENAME TABLE\n    Aurora--\x3e>Ghost: \u5207\u6362\u6210\u529f (\u65e7\u8868\u53d8 _del, \u65b0\u8868\u4e0a\u4f4d)\n    deactivate Ghost\n    \n    Note over Aurora, DTS: \u26a0\ufe0f \u5173\u952e\u65f6\u523b\uff1aDTS \u5904\u7406 RENAME\n    Aurora->>DTS: Binlog \u63a8\u9001 RENAME DDL\n\n    alt DTS \u7b56\u7565 A (\u5df2\u914d\u7f6e\u5ffd\u7565DDL)\n        DTS->>DTS: \u81ea\u52a8\u5ffd\u7565 RENAME, \u7ee7\u7eed\u540c\u6b65\n    else DTS \u7b56\u7565 B (\u9ed8\u8ba4\u62a5\u9519)\n        DTS--x User: \u274c \u4efb\u52a1\u62a5\u9519\u6302\u8d77 (Table doesn\'t exist)\n        User->>DTS: 9. \u63a7\u5236\u53f0\u70b9\u51fb "\u8df3\u8fc7/\u5ffd\u7565" \u5f53\u524d DDL\n        DTS->>Down: \u6062\u590d\u540c\u6b65\n    end\n\n    Note over User, Down: \ud83c\udf89 \u7b2c\u4e94\u9636\u6bb5\uff1a\u6536\u5c3e\n    User->>Down: \u9a8c\u8bc1\u6570\u636e\u5199\u5165\u6b63\u5e38\n    User->>Aurora: (24\u5c0f\u65f6\u540e) \u5220\u9664 _del \u8868'})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453(e,n,r){r.d(n,{R:()=>i,x:()=>a});var o=r(96540);const t={},s=o.createContext(t);function i(e){const n=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);